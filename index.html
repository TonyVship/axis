<!doctype html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Axis - 360 Video Rendering Engine</title>
    <link rel="stylesheet" href="build/build.css" type="text/css" />
    <script type="text/javascript" charset="utf-8" src="build/build.js"></script>
    <style type="text/css" media="all">
      body {
        display: block;
        position: relative;
        margin: 0;
        padding: 0;
        font-size: 14px;
        line-height: 1.7;
        color: #444;
        background-color: #fff;
        font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
      }

      #title {
        position: relative;
        display: block;
        margin: 0 auto;
        font-size: 32px;
        font-weight: 100;
        text-align: center;
      }

      #title i {
        margin-right: 10px;
      }

      #heading {
        display: block;
        position: relative;
        padding: 15px;
        border-top: 1px solid #ccc;
        box-shadow: 0px 2px 2px -2px #f4002b;
        font-size: 18px;
        text-align: center;
        background: #cecece;
      }

      .video {
        display: block;
        position: relative;
        width: 100%;
        height: auto;
        margin: 0 auto;
        margin-top: 20px;
        padding: 0;
        border-radius: 3px;
        background: #181818;
      }

      #meta {
        display: block;
        position: relative;
        margin: 0;
        margin-top: 20px;
        padding: 10px;
        font-size: 16px;
      }

      #meta > span:not(:last-child)::after {
        content: ' - ';
        margin: 0 5px;
      }

      #meta i {
        margin-right: 5px;
      }

      #meta a {
        color: #444;
        text-decoration: none;
      }

      #meta a:hover {
        text-decoration: underline;
      }

      #preview {
        display: block;
        position: relative;
        width: 500px;
        height: 250px;
      }
    </style>
  </head>
  <body>
    <h3 id="title">
      <i class="fa fa-video-camera"></i>Axis 360 Video Test
    </h3>
    <button id="go-fullscreen">Go fullscreen</button>
    <button id="toggle-vr-mode">Toggle VR Mode</button>
    <button id="enable-pointer-lock">Enable Pointer Lock</button>
    <button id="toggle-mouse-movement-control">Toggle Mouse Movements Control</button>
    <h4>Preview</h4>
    <img id="preview"/>
    <div class="normal video"></div>
    <div class="vsn video"></div>
    <script type="text/javascript" charset="utf-8">
      //DEBUG=1
    var frame = new Axis(document.querySelector('.normal.video'), {
        allowPreviewFrame: true,
        crossorigin: true,
        resizable: true,
        preload: true,
        autoplay: true,
        width: window.innerWidth * .8,
        height: window.innerHeight * .8,
        loop: true,
        muted: true,
        //src: 'https://d3uo9a4kiyu5sk.cloudfront.net/production/90598eca-0ec1-4677-bd13-495cd3c09dd8/web.mp4'
        //src: 'test.webm'
        src: '/public/assets/paramotor.mp4'
        //src: '/public/assets/hostel-luego.jpg'
        //src: 'public/assets/vsn.mp4',
        //src: 'http://360.littlstar.com/production/a0a5746e-87ac-4f20-9724-ecba40429e54/mobile.mp4',
        //src: 'http://360.littlstar.com/production/0f87492e-647e-4862-adb2-73e70160f5ea/mobile.mp4'
      });

      frame.on('vrhmdavailable', function (e) {
        console.log(e)
      });
      frame.render();

      frame.once('ready', function () {
        frame.focus();
        //frame.rotate('y', {value: 0.005, every: 100});
        //updatePreview();
        //setInterval(updatePreview, 2000);
      });

      function updatePreview () {
        frame.toImage(document.querySelector('#preview'));
      }

      document.querySelector('#go-fullscreen')
      .addEventListener('click', function () {
        frame.fullscreen(frame.el);
      });

      var isVREnabled = false;
      document.querySelector('#toggle-vr-mode')
      .addEventListener('click', function () {
        if (isVREnabled) { frame.disableVRMode(); }
        else { frame.enableVRMode(); }
        isVREnabled = !isVREnabled;
      });

      document.querySelector('#enable-pointer-lock')
      .addEventListener('click', function () {
        frame.controls.pointer.request();
        });

      var isMouseMovementEnabled = false;
      document.querySelector('#toggle-mouse-movement-control')
      .addEventListener('click', function () {
        if (isMouseMovementEnabled) {
          frame.controls.movement.disable();
          frame.controls.mouse.enable();
        } else {
          frame.controls.movement.enable();
          frame.controls.mouse.disable();
        }

        isMouseMovementEnabled = !isMouseMovementEnabled;
      });
      /*var vsn = new Axis(document.querySelector('.vsn.video'), {
        src: 'public/assets/vsn.mp4',
        resizable: true,
        autoplay: true,
        wheel: true,
        crossorigin: true
      });

      vsn.render();*/

    </script>
    <script type="text/javascript">
    </script>
  </body>
</html>
